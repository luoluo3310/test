"use strict";(self["webpackChunknebula_web"]=self["webpackChunknebula_web"]||[]).push([[576],{99852:function(t,e,s){s.d(e,{Z:function(){return g}});var a=function(){var t=this,e=t._self._c;return t.item.user?e("div",{staticClass:"item",on:{click:function(e){return t.handItem(t.item)}}},[e("div",{staticClass:"item_left"},[t.item.isFocuse?e("div",{staticClass:"focus"},[e("span",{staticClass:"iconfont icon-xunhuan icon"})]):t._e(),e("div",{staticClass:"avatar",on:{click:function(e){return t.handAvatar(t.item)}}},[t.item.user?e("img",{attrs:{src:t.baseUrl+t.item.user.avatar}}):e("img",{attrs:{src:t.defaultAvatar}})])]),e("div",{staticClass:"item_right"},[t.item.isFocuse?e("div",{staticClass:"focus"},[t._v(" "+t._s(t.item.call?t.item.call:" ")+" ")]):t._e(),e("div",{staticClass:"info"},[e("span",{staticClass:"name"},[t._v(t._s(t.item.user.nickname))]),e("span",{staticClass:"time"},[t._v(t._s(t.dayjs(t.item.article.create_time).format("YYYY-MM-DD HH:mm:ss")))]),e("i",{staticClass:"el-icon-more more",on:{click:function(e){return t.handMore(t.item)}}})]),e("h3",[t._v(t._s(t.item.article.title))]),e("el-row",[t.item.article.price?e("div",{staticClass:"content play",domProps:{innerHTML:t._s(t.item.article.content)}}):e("div",{staticClass:"content",domProps:{innerHTML:t._s(t.item.article.content)}})]),t.item.article?e("el-row",{attrs:{align:"center"}},[e("el-col",{attrs:{span:6}},[e("span",{staticClass:"iconfont icon-comment-v2 icon",on:{click:function(e){return t.handComment(t.item)}}})]),e("el-col",{attrs:{span:6}},[e("span",{class:["iconfont","icon-xunhuan","icon",{" active ":t.item.isFocuse}],on:{click:function(e){return t.handFocuse(t.item)}}}),e("span",{staticClass:"num"},[t._v(t._s(t.item.article.renebula_count))])]),e("el-col",{attrs:{span:6}},[e("span",{staticClass:"iconfont icon-weiguanzhu icon",on:{click:function(e){return t.handLike(t.item)}}}),e("span",{staticClass:"num"},[t._v(t._s(t.item.article.like_count))])]),e("el-col",{attrs:{span:6}},[e("span",{staticClass:"iconfont icon-fenxiang icon",on:{click:function(e){return t.handShare(t.item)}}})])],1):t._e()],1)]):t._e()},i=[],r=s(41704),n=s(9741),o=s(24239),l=s(35085),c=s.n(l),d=s(46670),h=s.n(d);const u={},m=new(h())({network:"mainnet",cacheProvider:!0,providerOptions:u});var p={props:{val:Object},data(){return{baseUrl:r.FH,defaultAvatar:r.c1,item:this.val}},methods:{handItem(t){this.$emit("handItem",t)},async handMore(t){let e=o.Z.state.userInfo.user_address?o.Z.state.userInfo.user_address:JSON.parse(localStorage.getItem("userInfo")).user_address;if(t.article.price>0){const s=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});let a=await(0,n.CC)({article_id:t.article.article_id});if(0!=a.code)return s.close(),void this.$message.error(a.msg);if(a.data.is_pay)s.close(),this.goTweets(t.article,t.user,a.data.hash1);else{const a=await m.connect(),i=new(c())(a),o=new i.eth.Contract(r.OD,t.hash.contract_addr);let l=o.methods.checkPurchased(e).call({from:e}),d=o.methods.buyArticle(e).send({from:e});l.then((a=>{a?(s.close(),this.goTweets(t.article,t.user)):(this.$message.warning("Please check after paying."),d.then((async()=>{let a=o.methods.checkPurchased(e).call({from:e});a.then((async e=>{if(!e)return s.close(),void this.$message.warning("Please try again.");{let e=await(0,n.VE)({article_id:t.article.article_id});if(s.close(),0!=e.code)return void this.$message.error(e.msg);this.goTweets(t.article,t.user,e.data)}}))})).catch((t=>{s.close(),this.$message.error(t.message)})))}))}}else this.goTweets(t.article,t.user);this.$emit("handMore",t)},handAvatar(t){this.$emit("handAvatar",t)},handComment(t){this.$emit("handComment",t)},handFocuse(t){this.$emit("handFocuse",t)},handLike(t){this.$emit("handLike",t)},handShare(t){this.$emit("handShare",t)},goTweets(t,e,s=""){this.$router.push({name:"Tweets",params:{article:t,user:e,hash1:s}}),this.$bus.$emit("setHeader","Tweets")}}},v=p,_=s(43736),f=(0,_.Z)(v,a,i,!1,null,"31ed565f",null),g=f.exports},9803:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page otherProfile"},[e("img",{staticClass:"banner",attrs:{src:t.defaultBanner,alt:""}}),e("div",{staticClass:"other"},[e("div",{staticClass:"avatarbg"},[e("img",{staticClass:"avatar",attrs:{src:t.baseUrl+t.other.avatar,alt:""}})]),e("div",{staticClass:"btns"},[e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-more",circle:""}}),e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-message",circle:""}}),e("el-button",{class:["followed","btn","icon",{" isFollowed ":t.other.isFollow}],attrs:{round:""},on:{click:t.handFollow}},[t._v(" Follow ")])],1)]),e("div",{staticClass:"abstract"},[e("div",{staticClass:"name"},[t._v(t._s(t.other.nickname))]),e("div",{staticClass:"description"},[t._v(t._s(t.other.description))]),e("div",{staticClass:"time"},[e("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(t.dayjs(t.other.create_time).format("YYYY-MM-DD"))+" ")]),e("div",[e("span",{staticClass:"follow"},[e("span",[t._v(t._s(t.tweetsTotal))]),t._v(" Following ")])])]),e("div",{staticClass:"introduce"},[e("el-tabs",{attrs:{"tab-position":"top"},on:{"tab-click":t.handClick},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[e("el-tab-pane",{attrs:{label:"Tweets",name:"tweets"}},t._l(t.tweetsList,(function(s){return e("list-item",{key:s.articleId,attrs:{val:s},on:{handMore:t.handMore}})})),1),e("el-tab-pane",{attrs:{label:"Likes",name:"likes"}},t._l(t.likesList,(function(s){return e("list-item",{key:s.articleId,attrs:{val:s},on:{handMore:t.handMore,handAvatar:t.handAvatar}})})),1)],1)],1),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{background:"","current-page":"tweets"==t.tabs?t.tweetsCurrent:t.likesCurrent,"page-size":10,layout:"total, prev, pager, next",total:"tweets"==t.tabs?t.tweetsTotal:t.likesTotal},on:{"current-change":t.handleCurrentChange}})],1)])},i=[],r=s(99852),n=s(41704),o=s(9741),l=s(24239);let c=l.Z.state.userInfo?l.Z.state.userInfo:JSON.parse(localStorage.getItem("userInfo"));var d={name:"OtherProfile",components:{ListItem:r.Z},data(){return{baseUrl:n.FH,defaultAvatar:n.c1,defaultBanner:n.J2,user_address:"",other:{},tabs:"tweets",tweetsTotal:0,tweetsCurrent:1,likesTotal:0,likesCurrent:1,tweetsList:[],likesList:[],visible:!1,userInfo:c}},mounted(){this.user_address=this.$route.params.user_address,this.init()},methods:{handFollow(){this.other.isFollow=!this.other.isFollow},init(){this.getUserInfo(),this.patchArticle()},async patchArticle(t=1){this.tweetsList=[];let e={user_address:this.user_address,page_no:t,page_size:10},s=await(0,o.By)(e);0==s.code?(this.tweetsList=s.data.data,this.tweetsTotal=s.data.page.total):this.$message.error(s.msg)},async patchLikeArticle(t=1){this.likesList=[];let e={user_address:this.user_address,page_no:t,page_size:10},s=await(0,o.Gk)(e);0==s.code?(this.likesList=s.data.data,this.likesTotal=s.data.page.total):this.$message.error(s.msg)},async getUserInfo(){let t={user_address:this.user_address},e=await(0,o.bG)(t);0==e.code&&(this.other=e.data)},handleCurrentChange(t){if("tweets"==this.tabs)return this.patchArticle(t),void(this.tweetsCurrent=t);this.likesCurrent=t},handMore(t){this.$bus.$emit("setHeader","Tweets"),this.$router.push({name:"Tweets",params:{article:t.article,user:t.user}})},handClick({name:t}){"tweets"!=t?this.patchLikeArticle():this.patchArticle()},handAvatar(t){if(t.user.user_address===c.user_address)return this.$router.push({name:"Profile"}),this.$bus.$emit("setHeader","Profile"),void this.$bus.$emit("setMenu","/profile");this.$router.push({name:"Other",params:{user_address:t.user.user_address}}),this.$bus.$emit("setHeader",t.user.nickname)}}},h=d,u=s(43736),m=(0,u.Z)(h,a,i,!1,null,"14c81952",null),p=m.exports}}]);