"use strict";(self["webpackChunknebula_web"]=self["webpackChunknebula_web"]||[]).push([[166],{20011:function(t,s,a){a.r(s),a.d(s,{default:function(){return b}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"page twees"},[s("div",{staticClass:"article_area"},[s("div",{staticClass:"authorInfo"},[s("div",{staticClass:"basic"},[s("img",{staticClass:"avatar",attrs:{src:t.baseUrl+t.articleUserInfo.avatar,alt:""}}),s("span",[t._v(t._s(t.articleUserInfo.nickname))])]),s("i",{staticClass:"el-icon-more more"})]),s("h3",[t._v(t._s(t.articleInfo.title))]),s("div",{staticClass:"article"},[s("div",{ref:"content",staticClass:"article_content",domProps:{innerHTML:t._s(t.articleInfo.content)}}),t.articleInfo.price?s("div",{staticClass:"articlemask"},t._l(100,(function(a,e){return s("div",{key:e,staticStyle:{"line-height":"10px"}},[s("p",[t._v(t._s(t.articleUserInfo.nickname))])])})),0):t._e()]),s("div",{staticClass:"time"},[t._v(" "+t._s(t.dayjs(t.articleInfo.create_time).format("HH:mm:ss YYYY-MM-DD "))+" ")])]),s("div",{staticClass:"comments_area"},[s("div",{staticClass:"account"},[s("p",[s("span",[t._v(t._s(t.articleInfo.view_count))]),t._v("Retweets ")]),s("p",[s("span",[t._v(t._s(t.total))]),t._v("Comments ")]),s("p",[s("span",[t._v(t._s(t.articleInfo.like_count))]),t._v("Likes ")])]),s("div",{staticClass:"options"},[s("span",{staticClass:"iconfont icon-comment-v2 icon",on:{click:t.handComment}}),s("span",{staticClass:"iconfont icon-xunhuan icon"}),s("span",{staticClass:"iconfont icon-weiguanzhu icon",on:{click:t.handLike}}),s("span",{staticClass:"iconfont icon-fenxiang icon"})]),s("div",{staticClass:"users"},[s("div",{staticClass:"comment"},t._l(t.commentsList,(function(t){return s("comment-Item",{key:t.comment.comment_id,attrs:{val:t}})})),1)]),s("div",{staticClass:"pagination"},[s("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.params.page_no,"page-size":10,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)]),s("el-dialog",{attrs:{visible:t.commentsVisible,width:"40%"},on:{"update:visible":function(s){t.commentsVisible=s}}},[s("div",{staticClass:"modal"},[s("div",{staticClass:"avatarBox"},[s("img",{staticClass:"avatar",attrs:{src:t.baseUrl+t.userInfo.avatar,alt:""}})]),s("div",{staticClass:"content"},[s("div",{staticClass:"article"},[s("vab-quill",{ref:"tweetsQuill"})],1),s("div",{staticClass:"foot"},[s("el-button",{attrs:{type:"primary",round:""},on:{click:t.handPublish}},[t._v("Pubilsh")])],1)])])])],1)},i=[],n=function(){var t=this,s=t._self._c;return t.item.user?s("div",{staticClass:"item",on:{click:function(s){return t.handItem(t.item)}}},[s("div",{staticClass:"item_left"},[t.item.isFocuse?s("div",{staticClass:"focus"},[s("span",{staticClass:"iconfont icon-xunhuan icon"})]):t._e(),s("div",{staticClass:"avatar",on:{click:function(s){return t.handAvatar(t.item)}}},[t.item.user?s("img",{attrs:{src:t.baseUrl+t.item.user.avatar}}):s("img",{attrs:{src:t.defaultAvatar}})])]),s("div",{staticClass:"item_right"},[t.item.isFocuse?s("div",{staticClass:"focus"},[t._v(" "+t._s(t.item.call?t.item.call:" ")+" ")]):t._e(),s("div",{staticClass:"info"},[s("span",{staticClass:"name"},[t._v(t._s(t.item.user.nickname))]),s("span",{staticClass:"time"},[t._v(t._s(t.dayjs(t.item.comment.create_time).format("YYYY-MM-DD HH:mm:ss")))])]),s("el-row",[s("div",{staticClass:"content",domProps:{innerHTML:t._s(t.item.comment.content)}})])],1)]):t._e()},c=[],r=a(41704),o={props:{val:Object},data(){return{baseUrl:r.FH,defaultAvatar:r.c1,item:this.val}},methods:{handItem(t){this.$emit("handItem",t)},handAvatar(t){this.$emit("handAvatar",t)}}},l=o,m=a(43736),h=(0,m.Z)(l,n,c,!1,null,"55359242",null),d=h.exports,u=a(2658),v=a(9741),p=a(24239),_=a(99344),f={name:"Tweets",components:{CommentItem:d,VabQuill:u.Z},data(){return{baseUrl:r.FH,articleUserInfo:{},articleInfo:{},commentsList:[],params:{article_id:"",page_no:1,page_size:10},total:0,commentsVisible:!1,userInfo:{avatar:""},content:"",isLike:!1,hash1:""}},mounted(){this.init()},methods:{init(){this.params.article_id=this.$route.params.article.article_id,this.params.user_address=this.articleInfo.user_address,this.hash1=this.$route.params.hash1,this.getArticle(),this.patchComment()},async getArticle(){let t=await(0,v.fq)(this.params);0==t.code?(this.articleUserInfo=Object.assign({},t.data.user),this.articleInfo=Object.assign({},t.data.article),this.articleInfo.price>0&&this.getFiles(this.hash1)):this.$message.error(t.msg)},async patchComment(){let t=await(0,v.SX)(this.params);0!=t.code&&this.$message.error(t.msg),this.commentsList=t.data.data,this.params.page_no=t.data.page_no,this.total=t.data.page.total},handleCurrentChange(t){this.params.page_no=t,this.patchComment()},handComment(){this.commentsVisible=!0,this.content="",this.$refs.tweetsQuill.content="",this.getUserInfo()},async getUserInfo(){let t=await(0,v.bG)();0==t.code&&(this.userInfo=t.data,localStorage.setItem("userInfo",JSON.stringify(t.data)),p.Z.commit("SET_USERINFO",t.data))},async handPublish(){if(this.content=this.$refs.tweetsQuill.content,!this.content)return void this.$message.warning("The content cannot be empty!");let t={article_id:this.params.article_id,content:this.content,user_address:this.params.user_address},s=await(0,v.w)(t);0==s.code?(this.commentsVisible=!1,this.params.page_no=1,this.content="",this.$refs.tweetsQuill.content="",this.patchComment()):this.$message.error(s.msg)},async handLike(){let t={article_id:this.params.article_id},s=await(0,v.mT)(t);0==s.code?(this.isLike=!0,this.getArticle()):this.$message.error(s.msg)},async getFiles(t){var s=(0,_.A)();const a=await s.get(t),e=await a.files(),i=new FileReader;i.onload=()=>{this.articleInfo.content=i.result},i.readAsText(e[0])}}},C=f,g=(0,m.Z)(C,e,i,!1,null,"383cd972",null),b=g.exports}}]);